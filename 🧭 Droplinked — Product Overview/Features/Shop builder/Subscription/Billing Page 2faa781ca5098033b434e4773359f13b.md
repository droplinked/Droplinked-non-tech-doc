# Billing Page

**Feature ID:** SUB-002

**Category:** Subscription / Shop Builder

**Actors:** Merchant

**Channel:** Merchant Dashboard

**Status:** Writing Spec (Draft)

**Owner:** Behdad

---

## Part 1: Human-Readable Spec

### Problem Statement

Merchants need a centralized location to manage their billing information, view their current subscription status, and access their complete invoice history. The billing page should provide a clear overview of the active plan and maintain a searchable history of all past transactions.

### User Stories

- As a **merchant on Starter plan with no history**, I want to see an empty state with a button to view plans so that I can purchase a subscription.
- As a **merchant with an active plan**, I want to see my current plan details in the Overview tab so that I understand my subscription status.
- As a **merchant**, I want to view all my invoices in a table format so that I can track my billing history.
- As a **merchant**, I want to search through my invoices so that I can find specific transactions quickly.
- As a **merchant**, I want to click on an invoice to see details so that I can download or manage it.

### Key User Journeys

**Journey 1: Starter User with No History (Empty State)**

| Step | Actor | Action | System Response |
| --- | --- | --- | --- |
| 1 | Merchant (Starter) | Clicks "Billing" in sidebar | System checks billing history |
| 2 | System | No billing logs found | Shows empty state with message |
| 3 | Merchant | Sees empty state | "No active subscription" message displayed |
| 4 | Merchant | Clicks "View Plans" button | Redirects to Pricing page |

**Journey 2: New Subscription - First Purchase**

**Scenario:** Ali buys Pro Yearly on January 1, 2026

| Day | Event | Log Entry | Status | Amount | Notes |
| --- | --- | --- | --- | --- | --- |
| 1 | Ali buys Pro Yearly | new_subscription | paid | $270 | Card charged immediately |
| 1 | System creates renewal | renew | upcoming | $270 | Scheduled for Jan 1, 2027 |

**Billing Table Display:**

| Plan Name | Event | Cycle | Due Date | Amount | Status |
| --- | --- | --- | --- | --- | --- |
| Pro | new_subscription | Yearly | Jan 1, 2026 | $270.00 | paid |
| Pro | renew | Yearly | Jan 1, 2027 | $270.00 | upcoming |

**Journey 3: Upgrade Mid-Cycle - From Pro to Premium**

**Scenario:** Ali bought Pro Yearly on Jan 1, 2026. Upgrades to Premium Yearly on July 1, 2026 (6 months used, 6 months remaining).

**Calculation:**

- Pro Yearly paid: $270
- Time used: 6 months
- Credit = $270 √ó (6/12) = **$135**
- Premium Yearly: $540
- **Amount to Pay: $540 - $135 = $405**

**Billing Logs After Upgrade:**

| Log ID | Event | Plan | Status | Amount | Notes |
| --- | --- | --- | --- | --- | --- |
| 001 | new_subscription | Pro Yearly | paid | $270 | Original purchase |
| 002 | renew | Pro Yearly | **cancel** | $270 | Canceled due to upgrade |
| 003 | upgrade | Premium Yearly | paid | $405 | Credit applied: $135 |
| 004 | renew | Premium Yearly | upcoming | $540 | Scheduled for next year |

**Billing Table Display:**

| Plan Name | Event | Cycle | Due Date | Amount | Status |
| --- | --- | --- | --- | --- | --- |
| Pro | new_subscription | Yearly | Jan 1, 2026 | $270.00 | paid |
| Pro | renew | Yearly | Jan 1, 2027 | $270.00 | **cancel** |
| Premium | upgrade | Yearly | Jul 1, 2026 | $405.00 | paid |
| Premium | renew | Yearly | Jul 1, 2027 | $540.00 | upcoming |

**Journey 4: Cancel Active Subscription**

**Scenario:** Ali is on Premium Monthly (purchased Feb 1, 2026) and cancels on Feb 15, 2026.

| Log ID | Event | Plan | Status | Amount | Notes |
| --- | --- | --- | --- | --- | --- |
| 001 | new_subscription | Premium Monthly | paid | $50 | Feb 1, 2026 purchase |
| 002 | renew | Premium Monthly | **cancel** | $50 | Canceled by user on Feb 15 |

**Billing Table Display After Cancel:**

| Plan Name | Event | Cycle | Due Date | Amount | Status |
| --- | --- | --- | --- | --- | --- |
| Premium | new_subscription | Monthly | Feb 1, 2026 | $50.00 | paid |
| Premium | renew | Monthly | Mar 1, 2026 | $50.00 | **cancel** |

**Overview Tab Shows:**

- Current Plan: Premium
- Status: Expiring on Mar 1, 2026
- Auto-Renewal: Inactive

**Journey 5: Failed Renewal - Auto-Downgrade to Starter**

**Scenario:** Ali's card fails on renewal date (Mar 1, 2026).

| Log ID | Event | Plan | Status | Amount | Notes |
| --- | --- | --- | --- | --- | --- |
| 001 | renew | Premium Monthly | **cancel** | $50 | Card declined on Mar 1 |

**Result:**

- Upcoming log status ‚Üí `cancel`
- Merchant downgraded to Starter
- No new logs created for Starter

**Billing Table Display:**

| Plan Name | Event | Cycle | Due Date | Amount | Status |
| --- | --- | --- | --- | --- | --- |
| Premium | new_subscription | Monthly | Feb 1, 2026 | $50.00 | paid |
| Premium | renew | Monthly | Mar 1, 2026 | $50.00 | **cancel** |

**Journey 6: Reactivation After Expiry**

**Scenario:** Ali's plan expired, then buys Pro Monthly again on Apr 1, 2026.

| Log ID | Event | Plan | Status | Amount | Notes |
| --- | --- | --- | --- | --- | --- |
| 003 | reactivate | Pro Monthly | paid | $25 | New purchase after expiry |
| 004 | renew | Pro Monthly | upcoming | $25 | Scheduled for May 1, 2026 |

**Billing Table Display:**

| Plan Name | Event | Cycle | Due Date | Amount | Status |
| --- | --- | --- | --- | --- | --- |
| Premium | new_subscription | Monthly | Feb 1, 2026 | $50.00 | paid |
| Premium | renew | Monthly | Mar 1, 2026 | $50.00 | cancel |
| Pro | **reactivate** | Monthly | Apr 1, 2026 | $25.00 | paid |
| Pro | renew | Monthly | May 1, 2026 | $25.00 | upcoming |

### Scope

**‚úÖ In Scope:**

- Billing page accessible via dashboard sidebar
- Two tabs: Overview and Invoices
- Overview tab current plan display OR empty state
- Empty state for Starter users with no billing history
- "View Plans" button in empty state and header
- Subscription Overview card with plan details
- Payment Details card with billing info
- Invoices tab with searchable table
- Table columns: Transaction, Cycle, Due Date, Amount, Status
- Navigation to Invoice Detail page on row click

**‚ùå Out of Scope:**

- Invoice download (handled in Invoice Detail page)
- Subscription cancellation (handled in Invoice Detail page)
- Payment processing
- Plan upgrades (redirects to Pricing page)

### Acceptance Criteria

- [ ]  "Billing" navigation item appears in dashboard sidebar
- [ ]  Billing page loads with Overview tab selected by default
- [ ]  Starter users with no billing history see empty state
- [ ]  Empty state includes "View Plans" button
- [ ]  Clicking "View Plans" redirects to Pricing page
- [ ]  Users with active plan see Subscription Overview card
- [ ]  Subscription Overview shows: Current Plan, Cycle, Transaction, Due Date, Total Amount
- [ ]  Payment Details card shows: Payment Method, Billing Email, Auto-Renewal status
- [ ]  Header contains "View Plans" button linking to Pricing page
- [ ]  Invoices tab accessible via tab navigation
- [ ]  Invoices table displays all billing history
- [ ]  Table columns: Transaction, Cycle, Due Date, Amount, Status
- [ ]  Search bar filters invoices in real-time
- [ ]  Clicking any invoice row navigates to Invoice Detail page
- [ ]  Status column shows: Paid, Upcoming, Cancel

### Technical Notes

- Billing data fetched from subscription API
- Empty state condition: Current plan is Starter AND no billing logs exist
- Status values: `paid`, `upcoming`, `cancel`
- Transaction types: `new_subscription`, `renew`, `upgrade`, `reactivate`
- Search should filter by: Plan name, Transaction type, Date range

### Dependencies

- Subscription management API
- User authentication
- Pricing page (SUB-001)
- Invoice Detail page (SUB-003)

---

## Part 2: Implementation Details for Developers

### Table Structure Definition

**Invoices Table Columns:**

| Column | Data Type | Description | Example Values |
| --- | --- | --- | --- |
| Plan Name | String | Name of the subscription plan | Starter, Pro, Premium, Enterprise |
| Event | Enum | Type of billing event | new_subscription, renew, upgrade, reactivate |
| Cycle | Enum | Billing cycle duration | Monthly, Yearly, 3-Year |
| Due Date | Date | Date of the event or scheduled renewal | Feb 1, 2026 |
| Amount | Decimal | Charged or scheduled amount | $50.00, $270.00 |
| Status | Enum | Current status of this log entry | paid, upcoming, cancel |

**Status Values:**

| Status | Color/Indicator | Meaning | Actions Available |
| --- | --- | --- | --- |
| **paid** | Green/Success | Transaction completed | View Details, Download PDF |
| **upcoming** | Blue/Pending | Scheduled future billing | View Details, Cancel (if active) |
| **cancel** | Gray/Disabled | Will not process | View Details only |

**Event Types:**

| Event | When Created | Creates Invoice |
| --- | --- | --- |
| **new_subscription** | First purchase of any paid plan | Yes |
| **renew** | Auto-renewal scheduled or completed | Yes (if paid) |
| **upgrade** | Moving to higher tier or longer cycle | Yes |
| **reactivate** | Return from Starter after expiry | Yes |

### State Scenarios & Table Examples

### Scenario 1: Fresh Pro Monthly Purchase

**User:** Just bought Pro Monthly

| Plan Name | Event | Cycle | Due Date | Amount | Status |
| --- | --- | --- | --- | --- | --- |
| Pro | new_subscription | Monthly | Feb 1, 2026 | $25.00 | paid |
| Pro | renew | Monthly | Mar 1, 2026 | $25.00 | upcoming |

### Scenario 2: Long-Time User with Multiple Renewals

**User:** On Pro Yearly, renewed twice

| Plan Name | Event | Cycle | Due Date | Amount | Status |
| --- | --- | --- | --- | --- | --- |
| Pro | new_subscription | Yearly | Jan 1, 2024 | $270.00 | paid |
| Pro | renew | Yearly | Jan 1, 2025 | $270.00 | paid |
| Pro | renew | Yearly | Jan 1, 2026 | $270.00 | paid |
| Pro | renew | Yearly | Jan 1, 2027 | $270.00 | upcoming |

### Scenario 3: Complex History with Upgrade

**User:** Started Pro, upgraded to Premium, then canceled

| Plan Name | Event | Cycle | Due Date | Amount | Status |
| --- | --- | --- | --- | --- | --- |
| Pro | new_subscription | Yearly | Jan 1, 2026 | $270.00 | paid |
| Pro | renew | Yearly | Jan 1, 2027 | $270.00 | cancel |
| Premium | upgrade | Yearly | Jul 1, 2026 | $405.00 | paid |
| Premium | renew | Yearly | Jul 1, 2027 | $540.00 | cancel |

### Scenario 4: Reactivation After Expiry

**User:** Plan expired, then reactivated on Pro

| Plan Name | Event | Cycle | Due Date | Amount | Status |
| --- | --- | --- | --- | --- | --- |
| Premium | new_subscription | Monthly | Feb 1, 2026 | $50.00 | paid |
| Premium | renew | Monthly | Mar 1, 2026 | $50.00 | cancel |
| Pro | **reactivate** | Monthly | Apr 1, 2026 | $25.00 | paid |
| Pro | renew | Monthly | May 1, 2026 | $25.00 | upcoming |

### Implementation Rules

**For Table Rendering:**

1. Always sort by Due Date descending (newest first)
2. Show all logs regardless of status (paid, upcoming, cancel all visible)
3. Clicking any row navigates to Invoice Detail with that Log ID
4. Status column must use color coding:
    - paid: green/success badge
    - upcoming: blue/info badge
    - cancel: gray/muted badge

**For Search Functionality:**

- Search filters by: Plan Name, Event type, Date range
- Real-time filtering as user types
- Empty state if no results: "No invoices found"

**For Overview Tab:**

- Shows ONLY the currently active plan details
- If no active plan (on Starter): show empty state
- Auto-Renewal status reflects the upcoming log status

---

## UI Flow (Source of Truth)

```
[Click "Billing" in Sidebar]
    ‚Üì
[Check Subscription]
    ‚îú‚îÄ Starter + No History ‚Üí [Empty State] ‚Üí [View Plans] ‚Üí [Pricing Page]
    ‚îî‚îÄ Has Plan/History ‚Üí [Billing Page]
                              ‚Üì
                    [Overview Tab (Default)]
                              ‚îú‚îÄ [View Current Plan Info]
                              ‚îú‚îÄ [View Payment Details]
                              ‚îî‚îÄ [View Plans] ‚Üí [Pricing Page]
                              ‚Üì
                    [Invoices Tab]
                              ‚îú‚îÄ [Search Invoices]
                              ‚îî‚îÄ [Click Invoice Row] ‚Üí [Invoice Detail Page]
```

---

## Attachments

- üìé **Linked Request:** Subscription Management
- üìÑ **Spec Document:** Features/Shop builder/Subscription/
- üé® **Design:** Figma - Billing Page
- üß™ **Test Cases:** TBD

---

## Change Log

- 2026-02-22 ‚Äî Behdad ‚Äî Initial spec creation
- 2026-02-22 ‚Äî Behdad ‚Äî Split into Overview and Invoices tabs
- 2026-02-22 ‚Äî Behdad ‚Äî Added comprehensive table examples with upgrade, cancel, and reactivation scenarios
- 2026-02-22 ‚Äî Behdad ‚Äî Added Part 2: Implementation Details with table structure and state scenarios