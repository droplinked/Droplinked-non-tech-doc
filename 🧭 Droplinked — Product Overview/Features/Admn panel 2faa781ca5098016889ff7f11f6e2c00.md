# Admn panel

# Super Admin Panel

### Feature ID:

**[IAA-ADM-001]**

### Title:

**Super Admin Panel â€“ Platform Management Dashboard**

### Category:

**Administration** | **Actors**: Super Admin | **Channel**: Web Only

### Status:

**Defined**

### Owner:

Behdad

---

## PART 1: HUMAN-CENTRIC LAYER

---

### 1) **Summary**

**Problem/Value:**

The Droplinked platform requires a centralized administration interface for monitoring platform performance, managing merchants and shops, handling subscriptions, and performing manual operations like credit adjustments. The Super Admin Panel provides complete oversight and control of the platform's core entities.

**Desired Outcome:**

- Centralized KPI dashboard with time-based analytics
- Complete merchant and shop management
- Product and subscription oversight
- Manual subscription activation capability
- Shop creation by admin
- Customer support fee management
- Manual credit adjustments with audit logging
- Full activity logging for compliance and debugging

---

### 2) **Scope â€“ In / Out**

**In Scope:**

| Module | Features |
| --- | --- |
| **Authentication** | Login via main auth route (email/password) |
| **KPI Dashboard** | Time-based metrics, charts, period comparison |
| **Merchants List** | Search, view details, password reset |
| **Shops List** | Search, view details, referral info |
| **Products List** | Search, view details with SKUs |
| **Subscriptions List** | Search, view all subscriptions |
| **Plan Activation** | Manually activate plans for shops |
| **Shop Creation** | Create new shops/merchants |
| **Support Fee** | Configure recurring support fees |
| **Credit Management** | Manual credit adjustments |
| **Activity Logs** | All admin actions logged |

**Out of Scope:**

- Multiple admin roles (only Super Admin)
- Merchant/Shop suspension or ban
- Email/URL modifications
- Product deletion/deactivation
- Subscription cancellation
- Export functionality

---

### 3) **Pages Overview**

| # | Page | Purpose |
| --- | --- | --- |
| 1 | KPI Dashboard | Platform metrics and analytics |
| 2 | Merchants List | View and manage merchants |
| 3 | Merchant Detail | Individual merchant info + password reset |
| 4 | Shops List | View all shops |
| 5 | Shop Detail | Individual shop info + referrals |
| 6 | Products List | View all products |
| 7 | Product Detail | Product info with SKUs |
| 8 | Subscriptions List | View all subscriptions |
| 9 | Activate Plan | Manually activate subscription |
| 10 | Create Shop | Create new merchant/shop |
| 11 | Support Fee | Configure support fee for shop |
| 12 | Adjust Credit | Manual credit adjustment |

---

### 4) **Key User Journeys**

---

### **Journey 1: View Platform KPIs**

| Step | Actor | Action | System Response |
| --- | --- | --- | --- |
| 1 | Admin | Logs into admin panel | Dashboard loads |
| 2 | Admin | Selects date range | KPIs update for selected period |
| 3 | System | Displays metrics | Numbers + charts shown |
| 4 | Admin | Toggles "Compare with previous period" | Comparison data shown |

---

### **Journey 2: Find and View Merchant Details**

| Step | Actor | Action | System Response |
| --- | --- | --- | --- |
| 1 | Admin | Opens Merchants page | List loads |
| 2 | Admin | Searches by email or ID | Filtered results shown |
| 3 | Admin | Clicks on merchant row | Merchant detail page opens |
| 4 | Admin | Views shops, status, registration date | All info displayed |
| 5 | Admin | Clicks "Reset Password" | Password reset modal opens |
| 6 | Admin | Enters new password, confirms | Password updated, logged |

---

### **Journey 3: View Shop with Referrals**

| Step | Actor | Action | System Response |
| --- | --- | --- | --- |
| 1 | Admin | Opens Shops page | List loads |
| 2 | Admin | Searches by name or ID | Filtered results shown |
| 3 | Admin | Clicks on shop row | Shop detail page opens |
| 4 | Admin | Views shop info, products count | All info displayed |
| 5 | Admin | Scrolls to "Referred Shops" section | List of shops that used this shop's referral code |

---

### **Journey 4: Activate Plan for Shop**

| Step | Actor | Action | System Response |
| --- | --- | --- | --- |
| 1 | Admin | Opens "Activate Plan" page | Form loads |
| 2 | Admin | Enters shop URL | Shop validated and shown |
| 3 | Admin | Selects plan from dropdown | Plan selected |
| 4 | Admin | Selects duration (1mo/1yr/3yr) | Duration set |
| 5 | Admin | Enters price (can be $0) | Price set |
| 6 | Admin | Clicks "Activate" | Plan activated, logged |

---

### **Journey 5: Create New Shop**

| Step | Actor | Action | System Response |
| --- | --- | --- | --- |
| 1 | Admin | Opens "Create Shop" page | Form loads |
| 2 | Admin | Enters email + password | Required fields |
| 3a | Admin | Submits without shop details | Merchant created, must complete onboarding on login |
| 3b | Admin | Also enters name, URL, logo | Full shop created, skips onboarding |
| 4 | System | Validates email uniqueness | Error if email exists |
| 5 | System | Creates merchant/shop | Success, logged |

---

### **Journey 6: Configure Support Fee**

| Step | Actor | Action | System Response |
| --- | --- | --- | --- |
| 1 | Admin | Opens "Support Fee" page | Form loads |
| 2 | Admin | Enters shop URL/name | Shop found |
| 3 | Admin | Enters fee amount | Amount set |
| 4 | Admin | Selects period (Monthly/Yearly) | Period set |
| 5 | Admin | Enters description | Reason documented |
| 6 | Admin | Clicks "Enable" | Fee scheduled, logged |
| 7 | System | Periodically deducts from credit | Credit log updated |

---

### **Journey 7: Adjust Shop Credit**

| Step | Actor | Action | System Response |
| --- | --- | --- | --- |
| 1 | Admin | Opens "Adjust Credit" page | Form loads |
| 2 | Admin | Searches/selects shop | Shop shown with current balance |
| 3 | Admin | Selects category (Refund, Bonus, Penalty, etc.) | Category set |
| 4 | Admin | Enters amount (+/-) | Amount set |
| 5 | Admin | Enters description | Reason documented |
| 6 | Admin | Clicks "Apply" | Credit adjusted, logged |

---

### 5) **Business Acceptance Criteria (BAC)**

---

### **Authentication**

| ID | Criteria |
| --- | --- |
| BAC-1 | Admin login uses main authentication route (email/password) |
| BAC-2 | Only users with Super Admin role can access the panel |
| BAC-3 | All admin actions are logged with timestamp and admin ID |

---

### **KPI Dashboard**

| ID | Criteria |
| --- | --- |
| BAC-4 | Date picker allows selecting custom date range |
| BAC-5 | KPIs displayed: Completed Shops, Initial Signups, Verified Signups, Products Created |
| BAC-6 | Each KPI shown as number + chart |
| BAC-7 | Chart granularity matches selected date range |
| BAC-8 | "Compare with previous period" toggle shows comparison data |

---

### **Merchants**

| ID | Criteria |
| --- | --- |
| BAC-9 | Merchants list searchable by email or ID |
| BAC-10 | Table shows: Email, Status, Registration Date, ID |
| BAC-11 | Detail page shows: Email, Registration Date, Status, Shops (name + URL), Password Hash, ID |
| BAC-12 | Admin can reset merchant password |
| BAC-13 | Merchant statuses: PENDING, ACTIVE |

---

### **Shops**

| ID | Criteria |
| --- | --- |
| BAC-14 | Shops list searchable by name or ID |
| BAC-15 | Table shows: Name, Logo, URL, Creation Date, ID |
| BAC-16 | Detail page shows: Name, Logo, URL, Creation Date, ID, Products Count, Merchant Info |
| BAC-17 | Detail page shows list of shops referred by this shop |

---

### **Products**

| ID | Criteria |
| --- | --- |
| BAC-18 | Products list searchable by name or ID |
| BAC-19 | Table shows: Image, Title, Type, ID |
| BAC-20 | Detail page shows: Image, Title, SKUs list, Shop ID |

---

### **Subscriptions**

| ID | Criteria |
| --- | --- |
| BAC-21 | Subscriptions list searchable by ID |
| BAC-22 | Table shows: ID, Shop Name, Plan, Status, Purchase Date, Expiry Date, Payment Type |
| BAC-23 | Subscription statuses: ACTIVE, DEACTIVE, WAITING_FOR_PAYMENT, EXPIRED, CANCELED |

---

### **Plan Activation**

| ID | Criteria |
| --- | --- |
| BAC-24 | Admin enters shop URL to find shop |
| BAC-25 | Admin selects plan, duration (1mo/1yr/3yr), and price |
| BAC-26 | Price can be $0 (free activation) |
| BAC-27 | Plan activation starts from today |
| BAC-28 | Follows existing subscription logic for overlap handling |

---

### **Shop Creation**

| ID | Criteria |
| --- | --- |
| BAC-29 | Minimum required: Email + Password |
| BAC-30 | Optional: Shop Name, URL, Logo |
| BAC-31 | If only email/password: Merchant created, must complete onboarding on login |
| BAC-32 | If shop details provided: Full shop created, skips onboarding |
| BAC-33 | Error if email already exists |

---

### **Support Fee**

| ID | Criteria |
| --- | --- |
| BAC-34 | Admin selects shop and enters fee amount |
| BAC-35 | Periods available: Monthly, Yearly |
| BAC-36 | Description/notes field required |
| BAC-37 | Fee deducted periodically from shop credit |
| BAC-38 | Deduction logged in credit log |
| BAC-39 | Error shown if insufficient credit at deduction time |
| BAC-40 | Admin can disable an active support fee |

---

### **Credit Management**

| ID | Criteria |
| --- | --- |
| BAC-41 | Admin can add or subtract credit |
| BAC-42 | Credit can go negative |
| BAC-43 | Category selection required (Refund, Bonus, Penalty, Adjustment, Other) |
| BAC-44 | Description/notes field required |
| BAC-45 | All changes logged in credit log |
| BAC-46 | Credit log visible in shop detail page |

---

### ğŸ“œ Change Log

| Date | Author | Description of Changes | Reason |
| --- | --- | --- | --- |
| 2026-02-01 | Behdad | Initial document creation | New feature specification |

---

---

## PART 2: AI-CENTRIC LAYER (Functional Logic Depth)

---

### B1) Definitions & Glossary

| Term | Definition |
| --- | --- |
| **Super Admin** | Platform administrator with full access to admin panel |
| **Merchant** | User who owns one or more shops |
| **Shop** | E-commerce store created by a merchant |
| **Completed Shop** | Shop with URL configured (finished onboarding) |
| **Initial Signup** | Merchant account created (email verified) |
| **Verified Signup** | Merchant who completed email verification |
| **Referral** | Shop that was created using another shop's referral code |
| **Support Fee** | Recurring charge for customer support services |
| **Credit** | Shop's balance used for various platform fees |

---

### B2) Page Specifications

---

### **Page 1: KPI Dashboard**

**URL:** `/admin/dashboard`

**Layout:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  KPI Dashboard                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Date Range: [Jan 1, 2026] â†’ [Jan 31, 2026]  [Apply]           â”‚
â”‚  [âœ“] Compare with previous period                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Completed    â”‚ â”‚ Initial      â”‚ â”‚ Verified     â”‚ â”‚ Products â”‚â”‚
â”‚  â”‚ Shops        â”‚ â”‚ Signups      â”‚ â”‚ Signups      â”‚ â”‚ Created  â”‚â”‚
â”‚  â”‚              â”‚ â”‚              â”‚ â”‚              â”‚ â”‚          â”‚â”‚
â”‚  â”‚    156       â”‚ â”‚    1,234     â”‚ â”‚    890       â”‚ â”‚  5,678   â”‚â”‚
â”‚  â”‚   â–²12%       â”‚ â”‚   â–²8%        â”‚ â”‚   â–¼3%        â”‚ â”‚  â–²15%    â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                    [LINE CHART]                             â”‚â”‚
â”‚  â”‚         Daily/Weekly/Monthly based on range                 â”‚â”‚
â”‚  â”‚                                                             â”‚â”‚
â”‚  â”‚  â”€â”€â”€â”€ Current Period                                        â”‚â”‚
â”‚  â”‚  ---- Previous Period                                       â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

**KPI Definitions:**

| KPI | Definition | Query Logic |
| --- | --- | --- |
| Completed Shops | Shops with URL set | `WHERE shop.url IS NOT NULL AND created_at IN range` |
| Initial Signups | Merchant accounts created | `WHERE merchant.created_at IN range` |
| Verified Signups | Merchants with verified email | `WHERE merchant.email_verified = true AND verified_at IN range` |
| Products Created | Products created | `WHERE product.created_at IN range` |

**Chart Granularity Logic:**

```
IF range <= 7 days:
    granularity = "daily"
ELSE IF range <= 30 days:
    granularity = "daily"
ELSE IF range <= 90 days:
    granularity = "weekly"
ELSE:
    granularity = "monthly"

```

**Period Comparison Logic:**

```
IF compareWithPrevious == true:
    currentStart = selectedStart
    currentEnd = selectedEnd
    rangeDays = currentEnd - currentStart

    previousStart = currentStart - rangeDays
    previousEnd = currentStart - 1 day

    SHOW both periods on chart
    SHOW percentage change on each KPI card

```

---

### **Page 2: Merchants List**

**URL:** `/admin/merchants`

**Table Structure:**

| Column | Type | Sortable | Notes |
| --- | --- | --- | --- |
| Email | String | âœ… | Primary identifier |
| Status | Enum | âœ… | PENDING, ACTIVE |
| Registration Date | DateTime | âœ… | Account creation |
| ID | UUID | âŒ | System identifier |

**Search Logic:**

```
ON Search(query):
    IF query matches UUID format:
        FILTER BY merchant.id == query
    ELSE:
        FILTER BY merchant.email CONTAINS query (case-insensitive)

```

**Pagination:** 25 items per page

---

### **Page 3: Merchant Detail**

**URL:** `/admin/merchants/:id`

**Sections:**

| Section | Fields |
| --- | --- |
| **Basic Info** | Email, Registration Date, Status, Merchant ID |
| **Password** | Current Hash (masked), Reset Password button |
| **Shops** | List of shops with Name, URL (clickable) |

**Password Reset Flow:**

```
ON ClickResetPassword:
    OPEN Modal({
        title: "Reset Password",
        fields: [
            { name: "newPassword", type: "password", required: true },
            { name: "confirmPassword", type: "password", required: true }
        ]
    })

ON SubmitPasswordReset:
    IF newPassword != confirmPassword:
        SHOW error "Passwords do not match"
        RETURN

    IF newPassword.length < 8:
        SHOW error "Password must be at least 8 characters"
        RETURN

    API.updateMerchantPassword(merchantId, hash(newPassword))
    LOG activity("MERCHANT_PASSWORD_RESET", merchantId, adminId)
    SHOW success "Password updated successfully"
    CLOSE modal

```

---

### **Page 4: Shops List**

**URL:** `/admin/shops`

**Table Structure:**

| Column | Type | Notes |
| --- | --- | --- |
| Logo | Image | Thumbnail |
| Name | String | Shop name |
| URL | String | Shop URL (clickable) |
| Creation Date | DateTime | Shop creation |
| ID | UUID | System identifier |

**Search Logic:**

```
ON Search(query):
    IF query matches UUID format:
        FILTER BY shop.id == query
    ELSE:
        FILTER BY shop.name CONTAINS query (case-insensitive)

```

---

### **Page 5: Shop Detail**

**URL:** `/admin/shops/:id`

**Sections:**

| Section | Content |
| --- | --- |
| **Basic Info** | Name, Logo, URL, Creation Date, Shop ID |
| **Statistics** | Products Count |
| **Merchant Info** | Merchant ID (link), Merchant Email |
| **Credit** | Current Balance, [View Credit Log] button |
| **Referred Shops** | List of shops that used this shop's referral code |

**Referred Shops Table:**

| Column | Notes |
| --- | --- |
| Name | Shop name |
| URL | Shop URL |
| Storefront Link | External link to live shop |

**Logic for Referred Shops:**

```
referredShops = API.getShopsWithReferrer(shop.referral_code)
// Returns all shops where merchant signed up using this shop's referral code

```

**Credit Log Modal:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Credit Log - [Shop Name]                              [Close] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Date         â”‚ Type       â”‚ Amount   â”‚ Balance â”‚ Description  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  2026-01-15   â”‚ BONUS      â”‚ +$100.00 â”‚ $100.00 â”‚ Welcome bonusâ”‚
â”‚  2026-01-20   â”‚ SUPPORT_FEEâ”‚ -$25.00  â”‚ $75.00  â”‚ Monthly fee  â”‚
â”‚  2026-01-25   â”‚ PENALTY    â”‚ -$10.00  â”‚ $65.00  â”‚ Chargeback   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---

### **Page 6: Products List**

**URL:** `/admin/products`

**Table Structure:**

| Column | Type | Notes |
| --- | --- | --- |
| Image | Image | Primary image thumbnail |
| Title | String | Product title |
| Type | Enum | PHYSICAL, DIGITAL, POD |
| ID | UUID | System identifier |

**Search Logic:**

```
ON Search(query):
    IF query matches UUID format:
        FILTER BY product.id == query
    ELSE:
        FILTER BY product.title CONTAINS query (case-insensitive)

```

---

### **Page 7: Product Detail**

**URL:** `/admin/products/:id`

**Sections:**

| Section | Content |
| --- | --- |
| **Basic Info** | Image, Title, Product ID |
| **Shop** | Shop ID (link), Shop Name |
| **SKUs** | Table of all SKUs |

**SKU Table:**

| Column | Notes |
| --- | --- |
| SKU ID | System identifier |
| Variant Values | e.g., "Red / Large" |
| Price | SKU price |
| Stock | Quantity |

---

### **Page 8: Subscriptions List**

**URL:** `/admin/subscriptions`

**Table Structure:**

| Column | Type | Notes |
| --- | --- | --- |
| ID | UUID | Subscription ID |
| Shop Name | String | Shop name (link to shop) |
| Plan | String | Plan name |
| Status | Enum | ACTIVE, DEACTIVE, WAITING_FOR_PAYMENT, EXPIRED, CANCELED |
| Purchase Date | DateTime | When purchased |
| Expiry Date | DateTime | When expires |
| Payment Type | String | Payment method used |

**Search:** By subscription ID

**Status Badge Colors:**

| Status | Color |
| --- | --- |
| ACTIVE | Green |
| DEACTIVE | Gray |
| WAITING_FOR_PAYMENT | Yellow |
| EXPIRED | Red |
| CANCELED | Dark Gray |

---

### **Page 9: Activate Plan**

**URL:** `/admin/activate-plan`

**Form:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Activate Plan for Shop                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Shop URL:     [________________________] [Find]                â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€ Shop Found â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Name: My Awesome Shop                                     â”‚  â”‚
â”‚  â”‚ Current Plan: Free (Expires: N/A)                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  Plan:         [Pro Plan               â–¼]                       â”‚
â”‚                                                                 â”‚
â”‚  Duration:     (â—) 1 Month  ( ) 1 Year  ( ) 3 Years            â”‚
â”‚                                                                 â”‚
â”‚  Price:        [$_________] (Enter 0 for free activation)      â”‚
â”‚                                                                 â”‚
â”‚  Start Date:   February 1, 2026 (Today - Not editable)         â”‚
â”‚                                                                 â”‚
â”‚                                          [Cancel] [Activate]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

**Validation:**

```
ON ClickFind(url):
    shop = API.findShopByUrl(url)
    IF shop == null:
        SHOW error "Shop not found"
    ELSE:
        DISPLAY shop info
        LOAD current subscription

ON ClickActivate:
    IF shop == null:
        SHOW error "Please find a shop first"
        RETURN

    IF plan == null:
        SHOW error "Please select a plan"
        RETURN

    IF price < 0:
        SHOW error "Price cannot be negative"
        RETURN

    // Follow subscription logic for overlap handling
    API.activatePlan({
        shop_id: shop.id,
        plan_id: plan.id,
        duration: selectedDuration,
        price: price,
        start_date: today(),
        activated_by: adminId
    })

    LOG activity("PLAN_ACTIVATED", shop.id, adminId, { plan, duration, price })
    SHOW success "Plan activated successfully"

```

---

### **Page 10: Create Shop**

**URL:** `/admin/create-shop`

**Form:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Create New Shop                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”€â”€ Merchant Credentials (Required) â”€â”€                          â”‚
â”‚                                                                 â”‚
â”‚  Email:        [________________________]                       â”‚
â”‚  Password:     [________________________]                       â”‚
â”‚                                                                 â”‚
â”‚  â”€â”€ Shop Details (Optional) â”€â”€                                  â”‚
â”‚                                                                 â”‚
â”‚  Shop Name:    [________________________]                       â”‚
â”‚  Shop URL:     [________________________]                       â”‚
â”‚  Logo:         [Upload Image]                                   â”‚
â”‚                                                                 â”‚
â”‚  â„¹ï¸ If shop details are provided, merchant will skip            â”‚
â”‚     onboarding and go directly to dashboard.                    â”‚
â”‚                                                                 â”‚
â”‚                                          [Cancel] [Create]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

**Validation & Logic:**

```
ON ClickCreate:
    // Validate required fields
    IF email.trim() == "":
        SHOW error "Email is required"
        RETURN

    IF NOT isValidEmail(email):
        SHOW error "Invalid email format"
        RETURN

    IF password.length < 8:
        SHOW error "Password must be at least 8 characters"
        RETURN

    // Check email uniqueness
    existingMerchant = API.findMerchantByEmail(email)
    IF existingMerchant != null:
        SHOW error "Email already registered"
        RETURN

    // Determine creation mode
    IF shopName AND shopUrl:
        // Full creation mode
        IF NOT isValidUrl(shopUrl):
            SHOW error "Invalid shop URL format"
            RETURN

        existingUrl = API.findShopByUrl(shopUrl)
        IF existingUrl != null:
            SHOW error "Shop URL already taken"
            RETURN

        merchant = API.createMerchant({
            email: email,
            password: hash(password),
            status: ACTIVE,
            onboarding_complete: true
        })

        shop = API.createShop({
            merchant_id: merchant.id,
            name: shopName,
            url: shopUrl,
            logo: uploadedLogo
        })

        LOG activity("SHOP_CREATED_FULL", shop.id, adminId)
    ELSE:
        // Minimal creation mode
        merchant = API.createMerchant({
            email: email,
            password: hash(password),
            status: ACTIVE,
            onboarding_complete: false
        })

        LOG activity("MERCHANT_CREATED", merchant.id, adminId)

    SHOW success "Created successfully"

```

---

### **Page 11: Support Fee Configuration**

**URL:** `/admin/support-fee`

**Form:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Customer Support Fee                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Shop:         [Search by name or URL    â–¼]                     â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€ Shop Info â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Name: My Awesome Shop                                     â”‚  â”‚
â”‚  â”‚ Current Credit: $250.00                                   â”‚  â”‚
â”‚  â”‚ Active Support Fee: $25/month (since Jan 1, 2026)         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  Fee Amount:   [$_________]                                     â”‚
â”‚                                                                 â”‚
â”‚  Period:       (â—) Monthly  ( ) Yearly                          â”‚
â”‚                                                                 â”‚
â”‚  Description:  [________________________________________]       â”‚
â”‚                [________________________________________]       â”‚
â”‚                                                                 â”‚
â”‚                         [Disable Current] [Cancel] [Enable]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

**Logic:**

```
ON SelectShop(shop):
    DISPLAY shop info
    currentFee = API.getActiveSupportFee(shop.id)
    IF currentFee:
        SHOW "Active Support Fee: $X/period (since DATE)"
        ENABLE "Disable Current" button
    ELSE:
        SHOW "No active support fee"
        DISABLE "Disable Current" button

ON ClickEnable:
    IF amount <= 0:
        SHOW error "Amount must be greater than 0"
        RETURN

    IF description.trim() == "":
        SHOW error "Description is required"
        RETURN

    API.createSupportFee({
        shop_id: shop.id,
        amount: amount,
        period: selectedPeriod, // MONTHLY or YEARLY
        description: description,
        created_by: adminId,
        next_charge_date: calculateNextChargeDate(period)
    })

    LOG activity("SUPPORT_FEE_ENABLED", shop.id, adminId, { amount, period })
    SHOW success "Support fee enabled"

ON ClickDisable:
    CONFIRM "Are you sure you want to disable the support fee?"
    IF confirmed:
        API.disableSupportFee(shop.id)
        LOG activity("SUPPORT_FEE_DISABLED", shop.id, adminId)
        SHOW success "Support fee disabled"

```

**Recurring Charge Logic (Cron Job):**

```
CRON JOB (daily):
    activeFees = API.getSupportFeesDueToday()

    FOR each fee in activeFees:
        shop = API.getShop(fee.shop_id)

        IF shop.credit >= fee.amount:
            API.deductCredit({
                shop_id: shop.id,
                amount: fee.amount,
                type: "SUPPORT_FEE",
                description: fee.description,
                reference_id: fee.id
            })

            fee.next_charge_date = calculateNextChargeDate(fee.period)
            API.updateSupportFee(fee)

            LOG credit("SUPPORT_FEE_CHARGED", shop.id, fee.amount)
        ELSE:
            LOG error("SUPPORT_FEE_FAILED_INSUFFICIENT_CREDIT", shop.id)
            // Fee remains pending, will retry next day or alert admin

```

---

### **Page 12: Adjust Credit**

**URL:** `/admin/adjust-credit`

**Form:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Adjust Shop Credit                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Shop:         [Search by name or URL    â–¼]                     â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€ Shop Info â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Name: My Awesome Shop                                     â”‚  â”‚
â”‚  â”‚ Current Credit: $250.00                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  Operation:    (â—) Add Credit  ( ) Subtract Credit              â”‚
â”‚                                                                 â”‚
â”‚  Amount:       [$_________]                                     â”‚
â”‚                                                                 â”‚
â”‚  Category:     [Refund                  â–¼]                      â”‚
â”‚                 â”œâ”€ Refund                                       â”‚
â”‚                 â”œâ”€ Bonus                                        â”‚
â”‚                 â”œâ”€ Penalty                                      â”‚
â”‚                 â”œâ”€ Adjustment                                   â”‚
â”‚                 â””â”€ Other                                        â”‚
â”‚                                                                 â”‚
â”‚  Description:  [________________________________________]       â”‚
â”‚                [________________________________________]       â”‚
â”‚                                                                 â”‚
â”‚  âš ï¸ Warning: Credit can go negative                             â”‚
â”‚                                                                 â”‚
â”‚  Preview:      $250.00 â†’ $350.00 (+$100.00)                     â”‚
â”‚                                                                 â”‚
â”‚                                          [Cancel] [Apply]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

**Category Enum:**

```
CREDIT_CATEGORY = [
    "REFUND",       // Customer refund processed
    "BONUS",        // Promotional credit
    "PENALTY",      // Chargeback, violation
    "ADJUSTMENT",   // Correction, reconciliation
    "OTHER"         // Miscellaneous
]

```

**Logic:**

```
ON SelectShop(shop):
    DISPLAY shop info with current credit
    UPDATE preview

ON AmountChange OR OperationChange:
    IF operation == "ADD":
        newBalance = currentCredit + amount
        preview = "$X â†’ $Y (+$Z)"
    ELSE:
        newBalance = currentCredit - amount
        preview = "$X â†’ $Y (-$Z)"

    IF newBalance < 0:
        SHOW warning "Credit will become negative"

ON ClickApply:
    IF amount <= 0:
        SHOW error "Amount must be greater than 0"
        RETURN

    IF category == null:
        SHOW error "Please select a category"
        RETURN

    IF description.trim() == "":
        SHOW error "Description is required"
        RETURN

    adjustmentAmount = (operation == "ADD") ? amount : -amount

    API.adjustCredit({
        shop_id: shop.id,
        amount: adjustmentAmount,
        category: category,
        description: description,
        adjusted_by: adminId
    })

    LOG activity("CREDIT_ADJUSTED", shop.id, adminId, {
        amount: adjustmentAmount,
        category: category,
        previousBalance: currentCredit,
        newBalance: currentCredit + adjustmentAmount
    })

    SHOW success "Credit adjusted successfully"
    REFRESH shop info

```

---

### B3) Activity Logging

All admin actions must be logged for audit purposes.

**Activity Log Table:**

| Field | Type | Description |
| --- | --- | --- |
| id | UUID | Log entry ID |
| action | Enum | Action type |
| entity_type | String | merchant, shop, subscription, etc. |
| entity_id | UUID | ID of affected entity |
| admin_id | UUID | Admin who performed action |
| metadata | JSON | Additional context |
| ip_address | String | Admin's IP address |
| created_at | DateTime | Timestamp |

**Action Types:**

| Action | Description |
| --- | --- |
| MERCHANT_PASSWORD_RESET | Admin reset merchant password |
| PLAN_ACTIVATED | Admin activated subscription |
| MERCHANT_CREATED | Admin created merchant (minimal) |
| SHOP_CREATED_FULL | Admin created full shop |
| SUPPORT_FEE_ENABLED | Admin enabled support fee |
| SUPPORT_FEE_DISABLED | Admin disabled support fee |
| CREDIT_ADJUSTED | Admin adjusted shop credit |

---

### B4) Data Models

**Merchant:**

```json
{
    "id": "uuid",
    "email": "string",
    "password_hash": "string",
    "status": "PENDING | ACTIVE",
    "email_verified": "boolean",
    "onboarding_complete": "boolean",
    "created_at": "datetime",
    "referred_by": "uuid | null"  // Referrer shop ID
}

```

**Shop:**

```json
{
    "id": "uuid",
    "merchant_id": "uuid",
    "name": "string",
    "url": "string",
    "logo": "string | null",
    "referral_code": "string",
    "credit": "decimal",
    "created_at": "datetime"
}

```

**Credit Log:**

```json
{
    "id": "uuid",
    "shop_id": "uuid",
    "amount": "decimal",
    "type": "REFUND | BONUS | PENALTY | ADJUSTMENT | SUPPORT_FEE | OTHER",
    "description": "string",
    "balance_after": "decimal",
    "created_by": "uuid | null",
    "created_at": "datetime"
}

```

**Support Fee:**

```json
{
    "id": "uuid",
    "shop_id": "uuid",
    "amount": "decimal",
    "period": "MONTHLY | YEARLY",
    "description": "string",
    "is_active": "boolean",
    "next_charge_date": "date",
    "created_by": "uuid",
    "created_at": "datetime",
    "disabled_at": "datetime | null"
}

```

---

### B5) Edge Cases & Error Handling

| Edge Case | Behavior |
| --- | --- |
| **EC-1:** Search returns no results | Show "No results found" message |
| **EC-2:** Shop URL already taken (create shop) | Error: "Shop URL already taken" |
| **EC-3:** Email already registered (create shop) | Error: "Email already registered" |
| **EC-4:** Insufficient credit for support fee | Log error, fee remains pending |
| **EC-5:** Credit becomes negative after adjustment | Allow with warning |
| **EC-6:** Admin tries to access non-existent entity | 404 page with "Not found" |
| **EC-7:** Concurrent credit adjustments | Use database transactions |
| **EC-8:** Password too weak | Error: "Password must be at least 8 characters" |
| **EC-9:** Invalid shop URL format | Error: "Invalid shop URL format" |

---

### B6) Test Case Hooks

| Test ID | Scenario | Expected Result |
| --- | --- | --- |
| TC-1 | Login with valid admin credentials | Access granted |
| TC-2 | Login with non-admin credentials | Access denied |
| TC-3 | View KPIs with date range | Data displayed correctly |
| TC-4 | Compare with previous period | Comparison shown |
| TC-5 | Search merchant by email | Merchant found |
| TC-6 | Search merchant by ID | Merchant found |
| TC-7 | Reset merchant password | Password updated, logged |
| TC-8 | View shop referrals | Referred shops listed |
| TC-9 | Activate plan with $0 price | Plan activated free |
| TC-10 | Activate plan with price | Plan activated with price |
| TC-11 | Create shop (email only) | Merchant created, onboarding required |
| TC-12 | Create shop (full details) | Full shop created |
| TC-13 | Create shop with existing email | Error shown |
| TC-14 | Enable support fee | Fee scheduled |
| TC-15 | Disable support fee | Fee disabled |
| TC-16 | Add credit | Credit increased, logged |
| TC-17 | Subtract credit (goes negative) | Allowed with warning |
| TC-18 | Support fee charged (sufficient credit) | Credit deducted |
| TC-19 | Support fee charged (insufficient credit) | Error logged |
| TC-20 | View credit log in shop detail | All transactions shown |